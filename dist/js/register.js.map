{"version":3,"file":"register.js","names":["API_BASE","toast","toastError","document","getElementById","addEventListener","async","e","preventDefault","username","value","email","password","role","errorEl","successEl","submitBtn","target","querySelector","textContent","disabled","res","fetch","method","headers","body","JSON","stringify","data","json","ok","errorMsg","message","successMsg","reset","err"],"sources":["register.js"],"mappings":"OACSA,aAAgB,kBAChBC,MAAOC,eAAkB,aAElCC,SAASC,eAAe,gBAAgBC,iBAAiB,SAAUC,MAAOC,IACtEA,EAAEC,iBAEF,MAAMC,EAAWN,SAASC,eAAe,YAAYM,MAC/CC,EAAQR,SAASC,eAAe,SAASM,MACzCE,EAAWT,SAASC,eAAe,YAAYM,MAC/CG,EAAOV,SAASC,eAAe,QAAQM,MACvCI,EAAUX,SAASC,eAAe,SAClCW,EAAYZ,SAASC,eAAe,WACpCY,EAAYT,EAAEU,OAAOC,cAAc,yBAGrCJ,IAASA,EAAQK,YAAc,IAC/BJ,IAAWA,EAAUI,YAAc,IACnCH,IAAWA,EAAUI,UAAW,GAEpC,IACI,MAAMC,QAAYC,MAAM,GAAGtB,qCAAsC,CAC7DuB,OAAQ,OACRC,QAAS,CACL,eAAgB,oBAEpBC,KAAMC,KAAKC,UAAU,CAAElB,WAAUE,QAAOC,WAAUC,WAGhDe,QAAaP,EAAIQ,OAEvB,IAAKR,EAAIS,GAAI,CAET,MAAMC,EAAWH,EAAKI,SAAW,mBAGjC,OAFIlB,IAASA,EAAQK,YAAcY,QACnC7B,WAAW6B,EAEf,CAGA,MAAME,EAAaL,EAAKI,SAAW,2DAC/BjB,IAAWA,EAAUI,YAAcc,GACvChC,MAAMgC,EAAY,WAGlB1B,EAAEU,OAAOiB,OAKb,CAAE,MAAOC,GACL,MAAMJ,EAAW,6BACbjB,IAASA,EAAQK,YAAcY,GACnC7B,WAAW6B,EACf,CAAE,QACMf,IAAWA,EAAUI,UAAW,EACxC","ignoreList":[],"sourcesContent":["// js/register.js v.2\r\nimport { API_BASE } from './api.js'\r\nimport { toast, toastError } from './toast.js'\r\n\r\ndocument.getElementById(\"registerForm\").addEventListener(\"submit\", async (e) => {\r\n    e.preventDefault()\r\n\r\n    const username = document.getElementById(\"username\").value\r\n    const email = document.getElementById(\"email\").value\r\n    const password = document.getElementById(\"password\").value\r\n    const role = document.getElementById(\"role\").value\r\n    const errorEl = document.getElementById(\"error\")\r\n    const successEl = document.getElementById(\"success\")\r\n    const submitBtn = e.target.querySelector('button[type=\"submit\"]')\r\n\r\n    // Czyść poprzednie komunikaty\r\n    if (errorEl) errorEl.textContent = ''\r\n    if (successEl) successEl.textContent = ''\r\n    if (submitBtn) submitBtn.disabled = true\r\n\r\n    try {\r\n        const res = await fetch(`${API_BASE}/api/auth/register-pending`, {\r\n            method: \"POST\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({ username, email, password, role })\r\n        })\r\n\r\n        const data = await res.json()\r\n\r\n        if (!res.ok) {\r\n            // Błąd z backendu\r\n            const errorMsg = data.message || \"Błąd rejestracji\"\r\n            if (errorEl) errorEl.textContent = errorMsg\r\n            toastError(errorMsg)\r\n            return\r\n        }\r\n\r\n        // Sukces\r\n        const successMsg = data.message || \"Wniosek rejestracyjny został przesłany do zatwierdzenia.\"\r\n        if (successEl) successEl.textContent = successMsg\r\n        toast(successMsg, 'success')\r\n        \r\n        // Resetuj formularz\r\n        e.target.reset()\r\n\r\n        // NIE PRZEKIEROWUJ AUTOMATYCZNIE - użytkownik zostaje na stronie rejestracji\r\n        // użytkownik może teraz zobaczyć komunikat sukcesu\r\n\r\n    } catch (err) {\r\n        const errorMsg = \"Błąd połączenia z serwerem\"\r\n        if (errorEl) errorEl.textContent = errorMsg\r\n        toastError(errorMsg)\r\n    } finally {\r\n        if (submitBtn) submitBtn.disabled = false\r\n    }\r\n})"]}