import{API_BASE}from"./api.js";function getParam(e){return new URL(window.location.href).searchParams.get(e)}function attachNextParam(){const e=encodeURIComponent(location.pathname+location.search),t=document.getElementById("btnLogin"),n=document.getElementById("btnRegister");t&&(t.href=`/login.html?next=${e}`),n&&(n.href=`/register.html?next=${e}`)}async function hydrateUserMenu(){const e=document.getElementById("btnLogin"),t=document.getElementById("btnRegister"),n=document.getElementById("userMenu"),a=document.getElementById("userName"),d=document.getElementById("linkAdmin"),o=document.getElementById("btnLogout"),i=document.getElementById("userToggle"),r=document.getElementById("userDropdown");if(e&&t&&n)try{const s=await fetch(`${API_BASE}/api/users/profile`,{credentials:"include"});if(!s.ok)throw new Error;const l=await s.json();e.style.display="none",t.style.display="none",n.style.display="",a.textContent=l.username||l.email||"UÅ¼ytkownik","admin"===l.role&&(d.style.display="block"),i.addEventListener("click",()=>{!r.hasAttribute("hidden")?(r.setAttribute("hidden",""),i.setAttribute("aria-expanded","false")):(r.removeAttribute("hidden"),i.setAttribute("aria-expanded","true"))}),o.addEventListener("click",async()=>{await fetch(`${API_BASE}/api/auth/logout`,{method:"POST",credentials:"include"}),location.href="/"})}catch{e.style.display="",t.style.display="",n.style.display="none",attachNextParam()}}document.addEventListener("DOMContentLoaded",()=>{hydrateUserMenu(),attachNextParam()});
//# sourceMappingURL=nav.js.map
